
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../02_scanners/">
      
      
        <link rel="next" href="../04_nikto_scanner/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Nmap Scanner - VulnScanAI Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nmap-scanner" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="VulnScanAI Documentation" class="md-header__button md-logo" aria-label="VulnScanAI Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VulnScanAI Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Nmap Scanner
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VulnScanAI Documentation" class="md-nav__button md-logo" aria-label="VulnScanAI Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    VulnScanAI Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../toc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Table of Contents
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    VulnScanAI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            VulnScanAI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    App Directory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            App Directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Scanners Directory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Scanners Directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_scanners/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Nmap Scanner
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Nmap Scanner
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-get_report_directoryscan_type" class="md-nav__link">
    <span class="md-ellipsis">
      1. get_report_directory(scan_type)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-run_nmapcommand_list" class="md-nav__link">
    <span class="md-ellipsis">
      2. run_nmap(command_list)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-generate_nmap_report_pdfscan_type-target-report_text-optionsnone" class="md-nav__link">
    <span class="md-ellipsis">
      3. generate_nmap_report_pdf(scan_type, target, report_text, options=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-run_port_scantarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      4. run_port_scan(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-run_tcp_syn_scantarget-portsnone-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      5. run_tcp_syn_scan(target, ports=None, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-run_aggressive_scantarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      6. run_aggressive_scan(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-run_os_detectiontarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      7. run_os_detection(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-run_fragmented_packet_scantarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      8. run_fragmented_packet_scan(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_nikto_scanner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nikto Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_zap_scanner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ZAP Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_mobsf_scanner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MobSF Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_sqlmap_scanner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQLMap Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_ssl_scanner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSL Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_prowler_scanner_aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prowler AWS Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10_prowler_scanner_gcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prowler GCP Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11_cloudsploit_scanner_azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CloudSploit Azure Scanner
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Views Directory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Views Directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12_views/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13_views_init/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14_main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15_auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16_genai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GenAI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17_analyze_report_ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI Report Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18_payments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Payments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Templates Directory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Templates Directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19_templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21_home/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22_about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23_contact_us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24_request_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Request Demo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25_login/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Login
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26_profile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Profile
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    extensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    forms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-get_report_directoryscan_type" class="md-nav__link">
    <span class="md-ellipsis">
      1. get_report_directory(scan_type)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-run_nmapcommand_list" class="md-nav__link">
    <span class="md-ellipsis">
      2. run_nmap(command_list)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-generate_nmap_report_pdfscan_type-target-report_text-optionsnone" class="md-nav__link">
    <span class="md-ellipsis">
      3. generate_nmap_report_pdf(scan_type, target, report_text, options=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-run_port_scantarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      4. run_port_scan(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-run_tcp_syn_scantarget-portsnone-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      5. run_tcp_syn_scan(target, ports=None, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-run_aggressive_scantarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      6. run_aggressive_scan(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-run_os_detectiontarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      7. run_os_detection(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-run_fragmented_packet_scantarget-optionsnone-user_idnone" class="md-nav__link">
    <span class="md-ellipsis">
      8. run_fragmented_packet_scan(target, options=None, user_id=None)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="nmap-scanner">Nmap Scanner</h1>
<p>This document details the functionality of the file <code>nmap_scanner.py</code>, which automates network scanning using Nmap. The script provides several functions to execute different types of Nmap scans, generate PDF reports from the scan results, and incorporates user identification within the reports.</p>
<h2 id="overview">Overview</h2>
<p>The script performs the following steps:</p>
<ol>
<li><strong>Defines Scan Types:</strong> Provides functions for various Nmap scan types, such as port scans, TCP SYN scans, aggressive scans, OS detection, and fragmented packet scans.</li>
<li><strong>Executes Nmap:</strong>  Runs the Nmap command with specified options and target.</li>
<li><strong>Generates PDF Report:</strong> Creates a formatted PDF report using <code>reportlab</code>, including the scan type, target, scan results, and a company logo. The reports are user-specific.</li>
<li><strong>Returns Report Filename:</strong>  Returns the filename of the generated PDF report.</li>
</ol>
<h2 id="functions">Functions</h2>
<h3 id="1-get_report_directoryscan_type">1. <code>get_report_directory(scan_type)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong> Determines and creates the directory where Nmap reports will be stored based on the scan type.</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Defines the base directory path as <code>reports/nmap</code> within the Flask application's root directory.</li>
<li>Creates a sub-directory based on the scan type.  The scan type is converted to lowercase and spaces are replaced with underscores (e.g., "Port Scan" becomes <code>port_scan</code>).</li>
<li>Uses <code>os.makedirs(specific_report_dir, exist_ok=True)</code> to create the directory if it doesn't exist. <code>exist_ok=True</code> prevents errors if the directory already exists.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">current_app</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="k">def</span><span class="w"> </span><span class="nf">get_report_directory</span><span class="p">(</span><span class="n">scan_type</span><span class="p">):</span>
</span><span id="__span-0-5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the specific directory for scan reports based on the scan type.&quot;&quot;&quot;</span>
</span><span id="__span-0-6">    <span class="n">report_dir_base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_app</span><span class="o">.</span><span class="n">root_path</span><span class="p">,</span> <span class="s1">&#39;reports&#39;</span><span class="p">,</span> <span class="s1">&#39;nmap&#39;</span><span class="p">)</span>
</span><span id="__span-0-7">    <span class="n">specific_report_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">report_dir_base</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">scan_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">_results&#39;</span><span class="p">)</span>
</span><span id="__span-0-8">    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">specific_report_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-9">    <span class="k">return</span> <span class="n">specific_report_dir</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h3 id="2-run_nmapcommand_list">2. <code>run_nmap(command_list)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong>  A helper function to execute Nmap commands using <code>subprocess</code>.</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Takes a list of strings representing the Nmap command and its arguments.</li>
<li>Executes the command using <code>subprocess.run</code> with <code>capture_output=True</code>, <code>text=True</code>, and <code>check=True</code>. <code>check=True</code> raises a <code>CalledProcessError</code> if the Nmap command returns a non-zero exit code (indicating an error).</li>
<li>Returns the standard output of the Nmap command.</li>
<li>Includes error handling for <code>CalledProcessError</code> and <code>FileNotFoundError</code>. If Nmap is not found, a specific error message is returned.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
</span><span id="__span-1-2">
</span><span id="__span-1-3"><span class="k">def</span><span class="w"> </span><span class="nf">run_nmap</span><span class="p">(</span><span class="n">command_list</span><span class="p">):</span>
</span><span id="__span-1-4"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to execute Nmap commands.&quot;&quot;&quot;</span>
</span><span id="__span-1-5">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-1-6">        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command_list</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-7">        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
</span><span id="__span-1-8">    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-1-9">        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error running Nmap: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-1-10">    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="__span-1-11">        <span class="k">return</span> <span class="s2">&quot;Error: Nmap not found. Please ensure Nmap is installed and in your system&#39;s PATH.&quot;</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h3 id="3-generate_nmap_report_pdfscan_type-target-report_text-optionsnone">3. <code>generate_nmap_report_pdf(scan_type, target, report_text, options=None)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong> Generates a PDF report from the Nmap scan results using the <code>reportlab</code> library.</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Generates a unique filename for the PDF report based on the user ID, scan type, and timestamp.</li>
<li>Initializes a <code>SimpleDocTemplate</code> for creating the PDF.</li>
<li>Defines custom styles for the title, body text, and other elements of the report using <code>ParagraphStyle</code> and <code>getSampleStyleSheet</code>. A modern font (<code>Helvetica</code>) is used.</li>
<li>Creates a <code>story</code> list to hold the content of the PDF.</li>
<li>Adds a company logo at the beginning and the end. It checks to ensure logo exists before attempting to add it.</li>
<li>Adds a title to the report.</li>
<li>Includes a report information table containing the scan initiator (username), timestamp, and target.</li>
<li>Formats the Nmap output, splitting it into lines and adding each line as a paragraph to the story.</li>
<li>Builds the PDF document using <code>doc.build(story)</code>.</li>
<li>Returns the filename of the generated PDF report.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-2-2"><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">current_app</span>
</span><span id="__span-2-3"><span class="kn">from</span><span class="w"> </span><span class="nn">flask_login</span><span class="w"> </span><span class="kn">import</span> <span class="n">current_user</span>
</span><span id="__span-2-4"><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-2-5"><span class="kn">from</span><span class="w"> </span><span class="nn">reportlab.pdfgen</span><span class="w"> </span><span class="kn">import</span> <span class="n">canvas</span>
</span><span id="__span-2-6"><span class="kn">from</span><span class="w"> </span><span class="nn">reportlab.lib.pagesizes</span><span class="w"> </span><span class="kn">import</span> <span class="n">letter</span>
</span><span id="__span-2-7"><span class="kn">from</span><span class="w"> </span><span class="nn">reportlab.lib.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">getSampleStyleSheet</span><span class="p">,</span> <span class="n">ParagraphStyle</span>
</span><span id="__span-2-8"><span class="kn">from</span><span class="w"> </span><span class="nn">reportlab.platypus</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleDocTemplate</span><span class="p">,</span> <span class="n">Paragraph</span><span class="p">,</span> <span class="n">Spacer</span><span class="p">,</span> <span class="n">Image</span>
</span><span id="__span-2-9"><span class="kn">from</span><span class="w"> </span><span class="nn">reportlab.lib.units</span><span class="w"> </span><span class="kn">import</span> <span class="n">inch</span>
</span><span id="__span-2-10"><span class="kn">from</span><span class="w"> </span><span class="nn">reportlab.lib.enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">TA_CENTER</span><span class="p">,</span> <span class="n">TA_LEFT</span>
</span><span id="__span-2-11">
</span><span id="__span-2-12"><span class="n">APP_ROOT</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)))</span>
</span><span id="__span-2-13"><span class="n">COMPANY_LOGO</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">APP_ROOT</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;company_logo.PNG&#39;</span><span class="p">)</span>  <span class="c1"># Replace with the actual filename</span>
</span><span id="__span-2-14">
</span><span id="__span-2-15"><span class="k">def</span><span class="w"> </span><span class="nf">generate_nmap_report_pdf</span><span class="p">(</span><span class="n">scan_type</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">report_text</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-2-16"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an improved PDF report from Nmap output with logo at the end, using username.&quot;&quot;&quot;</span>
</span><span id="__span-2-17">    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
</span><span id="__span-2-18">    <span class="n">report_dir</span> <span class="o">=</span> <span class="n">get_report_directory</span><span class="p">(</span><span class="n">scan_type</span><span class="p">)</span>
</span><span id="__span-2-19">    <span class="n">pdf_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">report_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">_nmap_</span><span class="si">{</span><span class="n">scan_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
</span><span id="__span-2-20">
</span><span id="__span-2-21">    <span class="n">doc</span> <span class="o">=</span> <span class="n">SimpleDocTemplate</span><span class="p">(</span><span class="n">pdf_filename</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="n">letter</span><span class="p">)</span>
</span><span id="__span-2-22">    <span class="n">styles</span> <span class="o">=</span> <span class="n">getSampleStyleSheet</span><span class="p">()</span>
</span><span id="__span-2-23">
</span><span id="__span-2-24">    <span class="c1"># Modern font style</span>
</span><span id="__span-2-25">    <span class="n">modern_style</span> <span class="o">=</span> <span class="n">ParagraphStyle</span><span class="p">(</span>
</span><span id="__span-2-26">        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Modern&#39;</span><span class="p">,</span>
</span><span id="__span-2-27">        <span class="n">parent</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="s1">&#39;Normal&#39;</span><span class="p">],</span>
</span><span id="__span-2-28">        <span class="n">fontName</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span>  <span class="c1"># You can change to a more specific modern font if available</span>
</span><span id="__span-2-29">        <span class="n">fontSize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
</span><span id="__span-2-30">        <span class="n">leading</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
</span><span id="__span-2-31">        <span class="n">alignment</span><span class="o">=</span><span class="n">TA_LEFT</span><span class="p">,</span>
</span><span id="__span-2-32">    <span class="p">)</span>
</span><span id="__span-2-33">
</span><span id="__span-2-34">    <span class="n">title_style</span> <span class="o">=</span> <span class="n">ParagraphStyle</span><span class="p">(</span>
</span><span id="__span-2-35">        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span>
</span><span id="__span-2-36">        <span class="n">parent</span><span class="o">=</span><span class="n">modern_style</span><span class="p">,</span>
</span><span id="__span-2-37">        <span class="n">fontSize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
</span><span id="__span-2-38">        <span class="n">leading</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
</span><span id="__span-2-39">        <span class="n">alignment</span><span class="o">=</span><span class="n">TA_CENTER</span><span class="p">,</span>
</span><span id="__span-2-40">        <span class="n">fontName</span><span class="o">=</span><span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span>
</span><span id="__span-2-41">    <span class="p">)</span>
</span><span id="__span-2-42">
</span><span id="__span-2-43">    <span class="n">story</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-44">
</span><span id="__span-2-45">    <span class="c1"># --- Header ---</span>
</span><span id="__span-2-46">    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">COMPANY_LOGO</span><span class="p">):</span>
</span><span id="__span-2-47">        <span class="n">logo_header</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">COMPANY_LOGO</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">inch</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">inch</span><span class="p">)</span>
</span><span id="__span-2-48">        <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logo_header</span><span class="p">)</span>
</span><span id="__span-2-49">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;logo added in header&quot;</span><span class="p">)</span>
</span><span id="__span-2-50">    <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spacer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">inch</span><span class="p">))</span>
</span><span id="__span-2-51">
</span><span id="__span-2-52">    <span class="c1"># --- Title ---</span>
</span><span id="__span-2-53">    <span class="n">title_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Nmap </span><span class="si">{</span><span class="n">scan_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> Report&quot;</span>
</span><span id="__span-2-54">    <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Paragraph</span><span class="p">(</span><span class="n">title_text</span><span class="p">,</span> <span class="n">title_style</span><span class="p">))</span>
</span><span id="__span-2-55">    <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spacer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">inch</span><span class="p">))</span>
</span><span id="__span-2-56">
</span><span id="__span-2-57">    <span class="c1"># --- Report Information ---</span>
</span><span id="__span-2-58">    <span class="n">report_info_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-2-59">        <span class="p">[</span><span class="s2">&quot;Scan Initiated By:&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_user</span><span class="o">.</span><span class="n">username</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">current_user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
</span><span id="__span-2-60">        <span class="p">[</span><span class="s2">&quot;Timestamp:&quot;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)],</span>
</span><span id="__span-2-61">        <span class="p">[</span><span class="s2">&quot;Target:&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span>
</span><span id="__span-2-62">    <span class="p">]</span>
</span><span id="__span-2-63">    <span class="kn">from</span><span class="w"> </span><span class="nn">reportlab.platypus</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">TableStyle</span>
</span><span id="__span-2-64">    <span class="n">report_info_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">report_info_data</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">inch</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">inch</span><span class="p">])</span>
</span><span id="__span-2-65">    <span class="n">report_info_table</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="n">TableStyle</span><span class="p">([</span>
</span><span id="__span-2-66">        <span class="p">(</span><span class="s1">&#39;FONTNAME&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">),</span>
</span><span id="__span-2-67">        <span class="p">(</span><span class="s1">&#39;ALIGN&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;LEFT&#39;</span><span class="p">),</span>
</span><span id="__span-2-68">        <span class="p">(</span><span class="s1">&#39;FONTSIZE&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">12</span><span class="p">),</span>
</span><span id="__span-2-69">        <span class="p">(</span><span class="s1">&#39;BOTTOMPADDING&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span>
</span><span id="__span-2-70">    <span class="p">]))</span>
</span><span id="__span-2-71">    <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">report_info_table</span><span class="p">)</span>
</span><span id="__span-2-72">    <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spacer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">inch</span><span class="p">))</span>
</span><span id="__span-2-73">
</span><span id="__span-2-74">    <span class="c1"># --- Report Content ---</span>
</span><span id="__span-2-75">    <span class="n">report_lines</span> <span class="o">=</span> <span class="n">report_text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="__span-2-76">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">report_lines</span><span class="p">:</span>
</span><span id="__span-2-77">        <span class="n">p</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">modern_style</span><span class="p">)</span>
</span><span id="__span-2-78">        <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="__span-2-79">        <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spacer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">inch</span><span class="p">))</span> <span class="c1"># Add a little space between lines</span>
</span><span id="__span-2-80">
</span><span id="__span-2-81">    <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spacer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">inch</span><span class="p">))</span>
</span><span id="__span-2-82">
</span><span id="__span-2-83">    <span class="c1"># --- Logo at the End ---</span>
</span><span id="__span-2-84">    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">COMPANY_LOGO</span><span class="p">):</span>
</span><span id="__span-2-85">        <span class="n">logo_footer</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">COMPANY_LOGO</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">inch</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">inch</span><span class="p">,</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;CENTER&#39;</span><span class="p">)</span>
</span><span id="__span-2-86">        <span class="n">story</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logo_footer</span><span class="p">)</span>
</span><span id="__span-2-87">
</span><span id="__span-2-88">    <span class="n">doc</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span id="__span-2-89">    <span class="k">return</span> <span class="n">pdf_filename</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h3 id="4-run_port_scantarget-optionsnone-user_idnone">4. <code>run_port_scan(target, options=None, user_id=None)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong>  Executes a basic Nmap port scan.</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Constructs the Nmap command with the specified target and any additional options.</li>
<li>Calls <code>run_nmap()</code> to execute the command.</li>
<li>If the Nmap command is successful (no "Error" in the output), calls <code>generate_nmap_report_pdf()</code> to create the PDF report.</li>
<li>Returns the filename of the PDF report if successful; otherwise, returns <code>None</code>.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><span class="k">def</span><span class="w"> </span><span class="nf">run_port_scan</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-3-2">    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nmap&#39;</span><span class="p">]</span>
</span><span id="__span-3-3">    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
</span><span id="__span-3-4">        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</span><span id="__span-3-5">    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-3-6">    <span class="n">report</span> <span class="o">=</span> <span class="n">run_nmap</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</span><span id="__span-3-7">    <span class="k">if</span> <span class="s2">&quot;Error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">report</span><span class="p">:</span>
</span><span id="__span-3-8">        <span class="k">return</span> <span class="n">generate_nmap_report_pdf</span><span class="p">(</span><span class="s2">&quot;Port Scan&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">report</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="__span-3-9">    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h3 id="5-run_tcp_syn_scantarget-portsnone-optionsnone-user_idnone">5. <code>run_tcp_syn_scan(target, ports=None, options=None, user_id=None)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong> Executes an Nmap TCP SYN scan (<code>-sS</code>).</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Constructs the Nmap command with the <code>-sS</code> flag, specified ports (if any), and any additional options.</li>
<li>Calls <code>run_nmap()</code> to execute the command.</li>
<li>If the Nmap command is successful (no "Error" in the output), calls <code>generate_nmap_report_pdf()</code> to create the PDF report.</li>
<li>Returns the filename of the PDF report if successful; otherwise, returns <code>None</code>.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><span class="k">def</span><span class="w"> </span><span class="nf">run_tcp_syn_scan</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">ports</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-4-2">    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nmap&#39;</span><span class="p">,</span> <span class="s1">&#39;-sS&#39;</span><span class="p">]</span>
</span><span id="__span-4-3">    <span class="k">if</span> <span class="n">ports</span><span class="p">:</span>
</span><span id="__span-4-4">        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">ports</span><span class="p">])</span>
</span><span id="__span-4-5">    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
</span><span id="__span-4-6">        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</span><span id="__span-4-7">    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-4-8">    <span class="n">report</span> <span class="o">=</span> <span class="n">run_nmap</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</span><span id="__span-4-9">    <span class="k">if</span> <span class="s2">&quot;Error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">report</span><span class="p">:</span>
</span><span id="__span-4-10">        <span class="k">return</span> <span class="n">generate_nmap_report_pdf</span><span class="p">(</span><span class="s2">&quot;TCP SYN Scan&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">report</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;-sS </span><span class="si">{</span><span class="s1">&#39;-p &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-11">    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h3 id="6-run_aggressive_scantarget-optionsnone-user_idnone">6. <code>run_aggressive_scan(target, options=None, user_id=None)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong> Executes an Nmap aggressive scan (<code>-A</code>).</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Constructs the Nmap command with the <code>-A</code> flag and any additional options.</li>
<li>Calls <code>run_nmap()</code> to execute the command.</li>
<li>If the Nmap command is successful (no "Error" in the output), calls <code>generate_nmap_report_pdf()</code> to create the PDF report.</li>
<li>Returns the filename of the PDF report if successful; otherwise, returns <code>None</code>.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><span class="k">def</span><span class="w"> </span><span class="nf">run_aggressive_scan</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-5-2">    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nmap&#39;</span><span class="p">,</span> <span class="s1">&#39;-A&#39;</span><span class="p">]</span>
</span><span id="__span-5-3">    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
</span><span id="__span-5-4">        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</span><span id="__span-5-5">    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-5-6">    <span class="n">report</span> <span class="o">=</span> <span class="n">run_nmap</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</span><span id="__span-5-7">    <span class="k">if</span> <span class="s2">&quot;Error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">report</span><span class="p">:</span>
</span><span id="__span-5-8">        <span class="k">return</span> <span class="n">generate_nmap_report_pdf</span><span class="p">(</span><span class="s2">&quot;Aggressive Scan&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">report</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;-A </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-5-9">    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h3 id="7-run_os_detectiontarget-optionsnone-user_idnone">7. <code>run_os_detection(target, options=None, user_id=None)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong> Executes an Nmap OS detection scan (<code>-O</code>).</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Constructs the Nmap command with the <code>-O</code> flag and any additional options.</li>
<li>Calls <code>run_nmap()</code> to execute the command.</li>
<li>If the Nmap command is successful (no "Error" in the output), calls <code>generate_nmap_report_pdf()</code> to create the PDF report.</li>
<li>Returns the filename of the PDF report if successful; otherwise, returns <code>None</code>.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><span class="k">def</span><span class="w"> </span><span class="nf">run_os_detection</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-6-2">    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nmap&#39;</span><span class="p">,</span> <span class="s1">&#39;-O&#39;</span><span class="p">]</span>
</span><span id="__span-6-3">    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
</span><span id="__span-6-4">        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</span><span id="__span-6-5">    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-6-6">    <span class="n">report</span> <span class="o">=</span> <span class="n">run_nmap</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</span><span id="__span-6-7">    <span class="k">if</span> <span class="s2">&quot;Error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">report</span><span class="p">:</span>
</span><span id="__span-6-8">        <span class="k">return</span> <span class="n">generate_nmap_report_pdf</span><span class="p">(</span><span class="s2">&quot;OS Detection&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">report</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;-O </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-9">    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h3 id="8-run_fragmented_packet_scantarget-optionsnone-user_idnone">8. <code>run_fragmented_packet_scan(target, options=None, user_id=None)</code></h3>
<ul>
<li>
<p><strong>Purpose:</strong> Executes an Nmap fragmented packet scan (<code>-f</code>).</p>
</li>
<li>
<p><strong>Functionality:</strong></p>
<ul>
<li>Constructs the Nmap command with the <code>-f</code> flag (fragmentation) and <code>-T5</code> (aggressively fast timing template) and any additional options.</li>
<li>Calls <code>run_nmap()</code> to execute the command.</li>
<li>If the Nmap command is successful (no "Error" in the output), calls <code>generate_nmap_report_pdf()</code> to create the PDF report.</li>
<li>Returns the filename of the PDF report if successful; otherwise, returns <code>None</code>.</li>
</ul>
</li>
<li>
<p><strong>Code Snippet:</strong></p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><span class="k">def</span><span class="w"> </span><span class="nf">run_fragmented_packet_scan</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-7-2">    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nmap&#39;</span><span class="p">,</span> <span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;-T5&#39;</span><span class="p">]</span>
</span><span id="__span-7-3">    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
</span><span id="__span-7-4">        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</span><span id="__span-7-5">    <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-7-6">    <span class="n">report</span> <span class="o">=</span> <span class="n">run_nmap</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</span><span id="__span-7-7">    <span class="k">if</span> <span class="s2">&quot;Error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">report</span><span class="p">:</span>
</span><span id="__span-7-8">        <span class="k">return</span> <span class="n">generate_nmap_report_pdf</span><span class="p">(</span><span class="s2">&quot;Fragmented Packet Scan&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">report</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;-f </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-9">    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<h2 id="dependencies">Dependencies</h2>
<ul>
<li><strong>Nmap:</strong>  A network scanning tool. Must be installed and in the system's PATH.</li>
<li><strong>Python Libraries:</strong><ul>
<li><code>subprocess</code>: For running external commands (Nmap).</li>
<li><code>os</code>: For file system operations.</li>
<li><code>flask</code>: For accessing the application's root path and configuration.</li>
<li><code>flask_login</code>: For accessing the current user's information.</li>
<li><code>datetime</code>: For generating unique report filenames.</li>
<li><code>reportlab</code>: For generating PDF reports (<code>pip install reportlab</code>).</li>
</ul>
</li>
</ul>
<h2 id="configuration">Configuration</h2>
<ul>
<li><strong><code>APP_ROOT</code></strong>:  Dynamically determines the application's root directory using <code>os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</code>.</li>
<li><strong><code>COMPANY_LOGO</code></strong>: Defines the path to the company logo image. Ensure the path is correct, and the logo image exists at the specified location. The logo path is relative to <code>APP_ROOT</code>.</li>
</ul>
<h2 id="error-handling">Error Handling</h2>
<p>The script includes error handling in the following areas:</p>
<ul>
<li><strong>Nmap Execution:</strong>  Handles <code>subprocess.CalledProcessError</code> if the Nmap command fails and <code>FileNotFoundError</code> if Nmap is not found.</li>
<li><strong>Report Generation:</strong> The Nmap report generation will not proceed if the nmap scan return any error.</li>
<li>The pdf reports are generated and saved correctly by creating relevant directory.</li>
</ul>
<h2 id="security-considerations">Security Considerations</h2>
<ul>
<li><strong>Nmap Execution:</strong>  Nmap scans can be intrusive and may be detected by intrusion detection systems (IDS).  Ensure you have permission to scan the target.</li>
<li><strong>Input Validation:</strong>  The target and options passed to Nmap should be validated to prevent command injection vulnerabilities.  While the provided code doesn't explicitly show validation, it's a critical security practice. Avoid directly incorporating untrusted input into the Nmap command string.</li>
<li><strong>Information Disclosure:</strong> Nmap scans can reveal sensitive information about the target system. Handle the scan results and reports securely. Limit access to the generated reports to authorized personnel.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>